#+TITLE: ox-pandoc

=ox-pandoc= is an 
[[https://orgmode.org/manual/Exporting.html#Exporting][exporter]] for
[[https://orgmode.org/][Org mode]] which converts Org-mode files to a
wide variety of other formats using the [[https://pandoc.org/][pandoc]]
tool. Pandoc can produce PDFs, HTML, presentations, markdown files,
office documents and e-pub publications as well as a number of other
more specialised formats.

* Supported Formats

You can convert an Org-mode file to various formats with simple
commands. The following table shows the supported formats:

| format            | extension | buffer | file |
|-------------------+-----------+--------+------|
| asciidoc          | txt       | yes    | yes  |
| beamer            | tex       | yes    | yes  |
| beamer-pdf        | pdf       | no     | yes  |
| commonmark        | md        | yes    | yes  |
| context           | tex       | yes    | yes  |
| docbook           | xml       | yes    | yes  |
| docx              |           | no     | yes  |
| dzslides          | html      | yes    | yes  |
| epub2             | epub      | no     | yes  |
| epub3             | epub      | no     | yes  |
| fb2               | fb2       | yes    | yes  |
| gfm               | md        | yes    | yes  |
| html4             | html      | yes    | yes  |
| html5             | html      | yes    | yes  |
| icml              |           | yes    | yes  |
| json              |           | yes    | yes  |
| latex             | tex       | yes    | yes  |
| latex-pdf         | pdf       | no     | yes  |
| man               |           | yes    | yes  |
| markdown          | md        | yes    | yes  |
| markdown_github   | md        | yes    | yes  |
| markdown_mmd      | md        | yes    | yes  |
| markdown_phpextra | md        | yes    | yes  |
| markdown_strict   | md        | yes    | yes  |
| mediawiki         |           | yes    | yes  |
| native            | hs        | yes    | yes  |
| odt               |           | no     | yes  |
| opendocument      | xml       | yes    | yes  |
| opml              |           | yes    | yes  |
| org               |           | yes    | yes  |
| plain             | txt       | yes    | yes  |
| pptx              |           | no     | yes  |
| revealjs          | html      | yes    | yes  |
| rst               |           | yes    | yes  |
| rtf               |           | yes    | yes  |
| s5                | html      | yes    | yes  |
| slideous          | html      | yes    | yes  |
| slidy             | html      | yes    | yes  |
| texinfo           | texi      | yes    | yes  |
| textile           |           | yes    | yes  |

* Requirements

You need Emacs 24.2, org-mode 8.2, and Pandoc 2.0 (or later
versions). 

Note that Org-mode equipped with Emacs 24.3 is version 7.9 and can not
be used with this tool. It is recommended to install Pandoc directly
from [[https://pandoc.org/installing.html][the official website]]. Other
package managers (such as Anaconda, apt) sometimes install old versions
of Pandoc.

By default, =ox-pandoc= will check on starting up whether there is a
suitable pandoc executable available. When none, or an older version is
found, a warning will be emitted. This warning can be suppressed by setting
customisation option =org-pandoc-check-version= to nil.

* Installation

You can install this tool with [[www.melpa.org][MELPA]].  For example,

#+BEGIN_SRC emacs-lisp
(setq package-archives
      '(("gnu" . "http://elpa.gnu.org/packages/")
        ("melpa" . "http://melpa.milkbox.net/packages/")))
#+END_SRC

: M-x package-install ⏎
: ox-pandoc ⏎

* Usage
** Using Org's export-dispatch menu
   As always in Org, =C-c C-e= brings up the export dispatch menu for
   the current org-mode file. =ox-pandoc= lives under the =p= key. By
   default, options are offered to convert the org-file to a number of
   commonly used formats, such as LaTeX, PDF and HTML.

   As pandoc supports many formats, the default
   =org-export-dispatch= shortcut menu does not show all the
   supported formats. You can customize =org-pandoc-menu-entry= variable
   (and probably restart Emacs) to change its default menu entries.

** Running the Commands directly

For example, to convert org-mode file to 'html5' format, you may run
the following commands.

- =org-pandoc-export-as-html5= :: Exports to the HTML5 text as a buffer.
- =org-pandoc-export-to-html5= :: Exports to the HTML5 text file.
- =org-pandoc-export-to-html5-and-open= :: Exports and open HTML5 file.

Similar commands are prepared for various formats.

** Customizing User Option Variables

You can specify the default options for each document format and
hooks.

- =org-pandoc-options= :: General Pandoc options.
- =org-pandoc-options-for-FORMAT= :: Format-specific options.
- =org-pandoc-after-processing-FORMAT-hook= :: Hook after processing
     =FORMAT=. This hook is only available to text-file =FORMAT=.
- =org-pandoc-epub-rights= :: EPUB Copyright Statement.

Options should be specified by an alist. List of valid options are
defined in =org-pandoc-valid-options=. Only long-name options can be
used. =after-processing= options can not be specified to =epub=,
=docx= or =pdf= formats. For preprocessing hooks, use
=org-export-before-processing-hook=.

Multiple values can be specified to options defined in
=org-pandoc-colon-separated-options=. They should be defined in
colon-separated list.

Values of options defined in =org-pandoc-file-options= will be
expanded to full path if they begin with =~= (tilde) character.

You can also specify output format extension with
=org-pandoc-format-extensions= variable.

For example:

#+BEGIN_SRC emacs-lisp
;; default options for all output formats
(setq org-pandoc-options '((standalone . t)))
;; cancel above settings only for 'docx' format
(setq org-pandoc-options-for-docx '((standalone . nil)))
;; special settings for beamer-pdf and latex-pdf exporters
(setq org-pandoc-options-for-beamer-pdf '((pdf-engine . "xelatex")))
(setq org-pandoc-options-for-latex-pdf '((pdf-engine . "pdflatex")))
;; special extensions for markdown_github output
(setq org-pandoc-format-extensions '(markdown_github+pipe_tables+raw_html))
#+END_SRC

** Document-Specific Options

Following document-specific options can be specified. Value =nil=
overrides preceding option setting. Value =t= means only specify
option, but not its value. Options are delimited by space.
=#+PANDOC_OPTIONS:= can be specified multiple times. If you want to
specify the option value which include space character, quote /entire/
option-value pair.

- =PANDOC_OPTIONS:= :: Add command line options to the Pandoc process.
- =PANDOC_METADATA:= :: Metadata for Pandoc.
- =PANDOC_EXTENSIONS:= :: Extensions for specific Pandoc output.
- =PANDOC_VARIABLES:= :: Variables for Pandoc.
- =EPUB_RIGHTS:= :: copyright info to be embedded to EPUB metadata.
- =EPUB_CHAPTER_LEVEL:= :: same as 'epub-chapter-level' pandoc-option.
- =EPUB_STYLESHEET:= :: same as 'epub-stylesheet' pandoc-option.
- =EPUB_COVER:= :: same as 'epub-cover-image' pandoc-option.
- =EPUB_FONT:= :: same as 'epub-embed-font' pandoc-option. Only one
                  font can be specified in each line. Multiple fonts
                  can be specified by repeatedly use this option.
- =EPUB_META:= :: put contents into a temporary file and specify
                  that file to 'epub-metadata' option.
- =EPUB_CSS:= :: put contents into a temporary file and specify
                 that file to 'epub-stylesheet' option.
- =BIBLIOGRAPHY:= :: same as 'bibliography' pandoc-option. Only one
     bibliography can be specified in each line. Multiple
     bibliographies can be specified by repeatedly use this option.

Following is an example:

: # If you don't want author to be appeared, just leave it empty.
: #+AUTHOR:
: #+PANDOC_OPTIONS: standalone:t pdf-engine:pdflatex
: ## When option value includes whitespace, entire name:value pair must be quoted.
: #+PANDOC_OPTIONS: "epub-cover-image:/home/a/test file.png" standalone:nil
: #+PANDOC_OPTIONS: number-sections:nil
: #+PANDOC_OPTIONS: template:mytemplate.tex
: #+BIBLIOGRAPHY: sample.bib
: # Specifying Multiple values to single options by using colon-sparated lists.
: #+PANDOC_OPTIONS: filter:pandoc-zotxt:pandoc-citeproc
: #+PANDOC_OPTIONS: csl:IEEE.csl
: #+PANDOC_EXTENSIONS: markdown-typography latex+auto_identifiers
: #+PANDOC_VARIABLES: documentclass:IEEEtran
: #+PANDOC_VARIABLES: classoption:10pt,conference
: #+PANDOC_METADATA: page-progression-direction:ltr
: #+latex_header: \author{\IEEEauthorblockN{John Smith}
: #+latex_header: \IEEEauthorblockA{FooBar Institute\\
: #+latex_header: Email: john.smith@foo.bar}

** Delayed loading of ox-pandoc
If you want delayed loading of `ox-pandoc' when
=org-pandoc-menu-entry= is customized, please consider the following
settings in your init file.

#+BEGIN_SRC emacs-lisp
(with-eval-after-load 'ox
  (require 'ox-pandoc))
#+END_SRC

* Comparisons.

** org-pandoc

This package is inspired by
[[https://github.com/robtillotson/org-pandoc][org-pandoc]], but entirely
re-written. The older package is not maintained.

** Babel, evaluating source code
Neither =org-pandoc= nor the =pandoc= tool itself know how to evaluate =SRC= blocks and prepare output from those code blocks for presentation formats. In =ox-pandoc=, =SRC= blocks in other languages are evaluated and the results prepared according to the headers before being passed to pandoc. 


* Notes
** Temporary Files

This file creates and removes "XXXX.tmpZZZZ.org" and
"XXXX.tmpZZZZ.css" (if necessary) temporary files in working directory.
(ZZZZ is random string.)

** Source Code Blocks

=ox-pandoc= supports the export of code blocks, including code blocks
for specific formats (e.g. LaTeX). Code wrapped in =BEGIN_EXPORT
[format]= will be passed to pandoc and included in the final output if
the output is of the appropriate format.

=ox-pandoc= also supports the evaluation of embedded code blocks wrapped
with =BEGIN_SRC [language]=. The various options described by the
[[https://orgmode.org/manual/Working-with-Source-Code.html#Working-with-Source-Code][Org-mode
manual]] for working with source code should be supported: source code,
results, both or neither can included in the final document and outputs
can be specified for particular output formats (e.g. HTML).

*IMPORTANT*: if you wish to include evaluated =SRC= blocks and their results in documents processed by pandoc, each should be given a unique name. For example.

#+BEGIN_EXAMPLE
#+NAME: my--block
#+BEGIN_SRC emacs-lisp :exports both :results value
(+ 4 7)
#+END_SRC
#+END_EXAMPLE

** Obsolete In-File Options

Following options are supported in previous version of =ox-pandoc=.
They are no longer supported.

- =EPUB_METADATA:= :: obsolete. Use =epub-metadata= in
     =PANDOC_OPTIONS:= instead.
- =EPUB_STYLESHEET:= :: obsolete. Use =epub-stylesheet= in
     =PANDOC_OPTIONS:= instead.

** Citation

Currently, Pandoc citation key is expressed as /@key/, rather than
/{\cite key}/ . You may need some text converter if you want to use
Pandoc citation styles in org document.

* License

  GPLv2.

* Author

- [[http://github.com/kawabata][kawabata]]
